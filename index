<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curb Crew - Bin Rolling Manager</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide React icons as inline SVG components
        const Users = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );
        
        const DollarSign = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );
        
        const Map = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
                <line x1="8" y1="2" x2="8" y2="18"></line>
                <line x1="16" y1="6" x2="16" y2="22"></line>
            </svg>
        );
        
        const Bell = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
        );
        
        const Phone = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </svg>
        );
        
        const Plus = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );
        
        const Edit2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
            </svg>
        );
        
        const Trash2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );
        
        const Save = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
        );
        
        const X = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );
        
        const MapPin = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
            </svg>
        );
        
        const Navigation = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="3 11 22 2 13 21 11 13 3 11"></polygon>
            </svg>
        );

        const BinBusinessApp = () => {
          const [activePage, setActivePage] = useState('clients');
          const [clients, setClients] = useState(() => {
            const saved = localStorage.getItem('clients');
            return saved ? JSON.parse(saved) : [
              { id: 1, name: 'John Smith', address: '123 Oak St', service: 'Weekly roll-out', payment: 'paid', phone: '555-0101', lat: 37.7749, lng: -122.4194 },
              { id: 2, name: 'Sarah Johnson', address: '456 Maple Ave', service: 'Bi-weekly + roll-back', payment: 'pending', phone: '555-0102', lat: 37.7759, lng: -122.4184 }
            ];
          });
          const [prices, setPrices] = useState(() => {
            const saved = localStorage.getItem('prices');
            return saved ? JSON.parse(saved) : [
              { id: 1, service: 'Weekly roll-out', price: '20.00' },
              { id: 2, service: 'Bi-weekly roll-out', price: '15.00' },
              { id: 3, service: 'Roll-back service', price: '10.00' },
              { id: 4, service: 'Special request', price: '25.00' }
            ];
          });
          const [notifications, setNotifications] = useState(() => {
            const saved = localStorage.getItem('notifications');
            return saved ? JSON.parse(saved) : [
              { id: 1, type: 'pickup', message: 'Pickup day tomorrow for 8 clients', date: 'Today', priority: 'high' },
              { id: 2, type: 'payment', message: 'Sarah Johnson payment pending', date: 'Today', priority: 'medium' },
              { id: 3, type: 'new', message: 'New client request received', date: 'Yesterday', priority: 'low' }
            ];
          });
          const [editingClient, setEditingClient] = useState(null);
          const [editingPrice, setEditingPrice] = useState(null);
          const [showAddClient, setShowAddClient] = useState(false);
          const [showAddPrice, setShowAddPrice] = useState(false);
          const [showAddNotification, setShowAddNotification] = useState(false);
          const [showRouteInfo, setShowRouteInfo] = useState(false);

          useEffect(() => {
            localStorage.setItem('clients', JSON.stringify(clients));
          }, [clients]);

          useEffect(() => {
            localStorage.setItem('prices', JSON.stringify(prices));
          }, [prices]);

          useEffect(() => {
            localStorage.setItem('notifications', JSON.stringify(notifications));
          }, [notifications]);

          const NavButton = ({ icon: Icon, label, page }) => (
            <button
              onClick={() => setActivePage(page)}
              className={`flex flex-col items-center justify-center p-3 transition-colors ${
                activePage === page ? 'text-blue-600 bg-blue-50' : 'text-gray-600 hover:bg-gray-50'
              }`}
            >
              <Icon size={24} />
              <span className="text-xs mt-1">{label}</span>
            </button>
          );

          const ClientList = () => {
            const handleSaveClient = (client) => {
              if (client.id) {
                setClients(clients.map(c => c.id === client.id ? client : c));
              } else {
                setClients([...clients, { ...client, id: Date.now() }]);
              }
              setEditingClient(null);
              setShowAddClient(false);
            };

            const handleDeleteClient = (id) => {
              setClients(clients.filter(c => c.id !== id));
            };

            return (
              <div className="p-4">
                <div className="flex justify-between items-center mb-4">
                  <h2 className="text-2xl font-bold text-gray-800">Clients</h2>
                  <button
                    onClick={() => setShowAddClient(true)}
                    className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700"
                  >
                    <Plus size={20} /> Add Client
                  </button>
                </div>

                {(showAddClient || editingClient) && (
                  <ClientForm
                    client={editingClient || { name: '', address: '', service: '', payment: 'pending', phone: '', lat: 37.7749, lng: -122.4194 }}
                    onSave={handleSaveClient}
                    onCancel={() => { setEditingClient(null); setShowAddClient(false); }}
                  />
                )}

                <div className="space-y-3">
                  {clients.map(client => (
                    <div key={client.id} className="bg-white rounded-lg shadow p-4 border border-gray-200">
                      <div className="flex justify-between items-start">
                        <div className="flex-1">
                          <h3 className="font-semibold text-lg text-gray-800">{client.name}</h3>
                          <p className="text-gray-600 text-sm">{client.address}</p>
                          <p className="text-gray-500 text-sm mt-1">{client.service}</p>
                          <p className="text-gray-500 text-sm">{client.phone}</p>
                          <span className={`inline-block mt-2 px-2 py-1 rounded text-xs font-medium ${
                            client.payment === 'paid' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'
                          }`}>
                            {client.payment === 'paid' ? 'Paid' : 'Pending'}
                          </span>
                        </div>
                        <div className="flex gap-2">
                          <button
                            onClick={() => setEditingClient(client)}
                            className="text-blue-600 hover:text-blue-800"
                          >
                            <Edit2 size={18} />
                          </button>
                          <button
                            onClick={() => handleDeleteClient(client.id)}
                            className="text-red-600 hover:text-red-800"
                          >
                            <Trash2 size={18} />
                          </button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            );
          };

          const ClientForm = ({ client, onSave, onCancel }) => {
            const [formData, setFormData] = useState(client);

            return (
              <div className="bg-blue-50 rounded-lg p-4 mb-4 border border-blue-200">
                <h3 className="font-semibold mb-3 text-gray-800">
                  {client.id ? 'Edit Client' : 'New Client'}
                </h3>
                <div className="space-y-3">
                  <input
                    type="text"
                    placeholder="Name"
                    value={formData.name}
                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                    className="w-full p-2 border rounded"
                  />
                  <input
                    type="text"
                    placeholder="Address"
                    value={formData.address}
                    onChange={(e) => setFormData({ ...formData, address: e.target.value })}
                    className="w-full p-2 border rounded"
                  />
                  <input
                    type="text"
                    placeholder="Phone"
                    value={formData.phone}
                    onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                    className="w-full p-2 border rounded"
                  />
                  <input
                    type="text"
                    placeholder="Service Notes"
                    value={formData.service}
                    onChange={(e) => setFormData({ ...formData, service: e.target.value })}
                    className="w-full p-2 border rounded"
                  />
                  <select
                    value={formData.payment}
                    onChange={(e) => setFormData({ ...formData, payment: e.target.value })}
                    className="w-full p-2 border rounded"
                  >
                    <option value="pending">Pending</option>
                    <option value="paid">Paid</option>
                  </select>
                  <div className="flex gap-2">
                    <button
                      onClick={() => onSave(formData)}
                      className="flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700 flex items-center justify-center gap-2"
                    >
                      <Save size={18} /> Save
                    </button>
                    <button
                      onClick={onCancel}
                      className="flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500 flex items-center justify-center gap-2"
                    >
                      <X size={18} /> Cancel
                    </button>
                  </div>
                </div>
              </div>
            );
          };

          const PricePage = () => {
            const handleSavePrice = (price) => {
              const formattedPrice = parseFloat(price.price).toFixed(2);
              if (price.id) {
                setPrices(prices.map(p => p.id === price.id ? { ...price, price: formattedPrice } : p));
              } else {
                setPrices([...prices, { ...price, id: Date.now(), price: formattedPrice }]);
              }
              setEditingPrice(null);
              setShowAddPrice(false);
            };

            const handleDeletePrice = (id) => {
              setPrices(prices.filter(p => p.id !== id));
            };

            return (
              <div className="p-4">
                <div className="flex justify-between items-center mb-4">
                  <h2 className="text-2xl font-bold text-gray-800">Service Prices</h2>
                  <button
                    onClick={() => setShowAddPrice(true)}
                    className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700"
                  >
                    <Plus size={20} /> Add Service
                  </button>
                </div>

                {(showAddPrice || editingPrice) && (
                  <div className="bg-blue-50 rounded-lg p-4 mb-4 border border-blue-200">
                    <h3 className="font-semibold mb-3 text-gray-800">
                      {editingPrice ? 'Edit Service' : 'New Service'}
                    </h3>
                    <div className="space-y-3">
                      <input
                        type="text"
                        placeholder="Service name"
                        value={editingPrice?.service || ''}
                        onChange={(e) => setEditingPrice({ ...editingPrice, service: e.target.value })}
                        className="w-full p-2 border rounded"
                      />
                      <input
                        type="text"
                        inputMode="decimal"
                        placeholder="Price (e.g., 1.50)"
                        value={editingPrice?.price || ''}
                        onChange={(e) => {
                          const value = e.target.value;
                          if (value === '' || /^\d*\.?\d*$/.test(value)) {
                            setEditingPrice({ ...editingPrice, price: value });
                          }
                        }}
                        className="w-full p-2 border rounded"
                      />
                      <div className="flex gap-2">
                        <button
                          onClick={() => handleSavePrice(editingPrice)}
                          className="flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700"
                        >
                          Save
                        </button>
                        <button
                          onClick={() => { setEditingPrice(null); setShowAddPrice(false); }}
                          className="flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500"
                        >
                          Cancel
                        </button>
                      </div>
                    </div>
                  </div>
                )}

                <div className="grid gap-3">
                  {prices.map(price => (
                    <div key={price.id} className="bg-white rounded-lg shadow p-4 border border-gray-200">
                      <div className="flex justify-between items-center">
                        <div>
                          <h3 className="font-semibold text-gray-800">{price.service}</h3>
                          <p className="text-2xl font-bold text-green-600 mt-1">${price.price}</p>
                        </div>
                        <div className="flex gap-2">
                          <button
                            onClick={() => setEditingPrice(price)}
                            className="text-blue-600 hover:text-blue-800"
                          >
                            <Edit2 size={18} />
                          </button>
                          <button
                            onClick={() => handleDeletePrice(price.id)}
                            className="text-red-600 hover:text-red-800"
                          >
                            <Trash2 size={18} />
                          </button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            );
          };

          const MapPage = () => {
            const optimizeRoute = () => {
              setShowRouteInfo(true);
            };

            const getOptimizedRoute = () => {
              return [...clients].sort((a, b) => a.address.localeCompare(b.address));
            };

            const optimizedClients = getOptimizedRoute();
            const totalStops = clients.length;
            const estimatedTimePerStop = 5;
            const estimatedDrivingTime = totalStops * 1;
            const totalTime = (totalStops * estimatedTimePerStop) + estimatedDrivingTime;

            return (
              <div className="p-4">
                <h2 className="text-2xl font-bold text-gray-800 mb-4">Service Map</h2>
                
                <div className="bg-gradient-to-br from-green-100 to-blue-100 rounded-lg p-8 mb-4 text-center border border-gray-300 relative overflow-hidden" style={{ height: '400px' }}>
                  <div className="absolute inset-0 opacity-10">
                    <div className="grid grid-cols-8 h-full">
                      {[...Array(64)].map((_, i) => (
                        <div key={i} className="border border-gray-400"></div>
                      ))}
                    </div>
                  </div>
                  <div className="relative z-10">
                    <MapPin size={48} className="mx-auto text-gray-600 mb-3" />
                    <p className="text-gray-700 font-medium">Interactive Map View</p>
                    <p className="text-sm text-gray-600 mt-2">Pin locations for each client</p>
                  </div>
                  
                  {clients.slice(0, 3).map((client, idx) => (
                    <div
                      key={client.id}
                      className="absolute bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-xs font-bold shadow-lg cursor-pointer hover:scale-110 transition-transform"
                      style={{
                        left: `${20 + idx * 30}%`,
                        top: `${30 + idx * 15}%`
                      }}
                      title={client.name}
                    >
                      {idx + 1}
                    </div>
                  ))}
                </div>

                <button 
                  onClick={optimizeRoute}
                  className="w-full bg-blue-600 text-white py-3 rounded-lg flex items-center justify-center gap-2 hover:bg-blue-700 mb-4"
                >
                  <Navigation size={20} /> Optimize Route
                </button>

                {showRouteInfo && (
                  <div className="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <div className="flex justify-between items-start mb-3">
                      <h3 className="font-semibold text-gray-800">Optimized Route Info</h3>
                      <button 
                        onClick={() => setShowRouteInfo(false)}
                        className="text-gray-600 hover:text-gray-800"
                      >
                        <X size={18} />
                      </button>
                    </div>
                    <div className="grid grid-cols-2 gap-3 text-sm mb-3">
                      <div className="bg-white rounded p-2">
                        <p className="text-gray-600">Total Stops</p>
                        <p className="text-xl font-bold text-blue-600">{totalStops}</p>
                      </div>
                      <div className="bg-white rounded p-2">
                        <p className="text-gray-600">Est. Time</p>
                        <p className="text-xl font-bold text-blue-600">{totalTime} min</p>
                      </div>
                    </div>
                    <p className="text-xs text-gray-600 mb-2">Route optimized by address sequence</p>
                  </div>
                )}

                <div className="space-y-2">
                  <h3 className="font-semibold text-gray-800 mb-2">
                    {showRouteInfo ? 'Suggested Route Order' : 'Client Locations'}
                  </h3>
                  {(showRouteInfo ? optimizedClients : clients).map((client, idx) => (
                    <div key={client.id} className="bg-white rounded-lg shadow p-3 border border-gray-200 flex items-center gap-3">
                      <div className="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold flex-shrink-0">
                        {idx + 1}
                      </div>
                      <div className="flex-1">
                        <p className="font-medium text-gray-800">{client.name}</p>
                        <p className="text-sm text-gray-600">{client.address}</p>
                      </div>
                      {showRouteInfo && (
                        <div className="text-xs text-gray-500">
                          ~{estimatedTimePerStop} min
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            );
          };

          const NotificationsPage = () => {
            const getPriorityColor = (priority) => {
              switch(priority) {
                case 'high': return 'bg-red-100 text-red-800 border-red-200';
                case 'medium': return 'bg-yellow-100 text-yellow-800 border-yellow-200';
                default: return 'bg-blue-100 text-blue-800 border-blue-200';
              }
            };

            const handleDismiss = (id) => {
              setNotifications(notifications.filter(n => n.id !== id));
            };

            const handleAddNotification = (notif) => {
              setNotifications([...notifications, { ...notif, id: Date.now(), date: 'Today' }]);
              setShowAddNotification(false);
            };

            return (
              <div className="p-4">
                <div className="flex justify-between items-center mb-2">
                  <h2 className="text-2xl font-bold text-gray-800">Notifications</h2>
                  <button
                    onClick={() => setShowAddNotification(true)}
                    className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700"
                  >
                    <Plus size={20} /> Add
                  </button>
                </div>
                <p className="text-sm text-gray-600 mb-4">Note: Clients should include their name when sending notifications</p>

                {showAddNotification && (
                  <div className="bg-blue-50 rounded-lg p-4 mb-4 border border-blue-200">
                    <h3 className="font-semibold mb-3 text-gray-800">New Notification</h3>
                    <div className="space-y-3">
                      <input
                        type="text"
                        placeholder="Notification message"
                        id="notif-message"
                        className="w-full p-2 border rounded"
                      />
                      <select
                        id="notif-priority"
                        className="w-full p-2 border rounded"
                        defaultValue="medium"
                      >
                        <option value="high">High Priority</option>
                        <option value="medium">Medium Priority</option>
                        <option value="low">Low Priority</option>
                      </select>
                      <select
                        id="notif-type"
                        className="w-full p-2 border rounded"
                        defaultValue="general"
                      >
                        <option value="pickup">Pickup</option>
                        <option value="payment">Payment</option>
                        <option value="new">New Client</option>
                        <option value="general">General</option>
                      </select>
                      <div className="flex gap-2">
                        <button
                          onClick={() => {
                            const message = document.getElementById('notif-message').value;
                            const priority = document.getElementById('notif-priority').value;
                            const type = document.getElementById('notif-type').value;
                            if (message) {
                              handleAddNotification({ message, priority, type });
                            }
                          }}
                          className="flex-1 bg-green-600 text-white py-2 rounded hover:bg-green
